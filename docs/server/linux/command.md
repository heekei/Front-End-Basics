# Linux 常用命令

## ps

`ps` 命令是 Process Status 的缩写，用于显示当前运行在系统上的进程信息，包括进程 ID（PID）、状态、运行时间、CPU 和内存占用等。ps 命令列出的是当前那些进程的快照，就是执行 ps 命令的那个时刻的那些进程，如果想要动态的显示进程信息，就可以使用 top 命令。

### 1. 参数介绍

`ps` 命令有许多参数，用于控制输出的格式和内容。常用的参数包括：

- `-e`：显示所有进程，包括没有终端的进程，等同于 `-A`。
- `-f`：显示完整格式的输出，包括进程的父进程 ID（PPID）、用户 ID（UID）、CPU 占用等。通常和其他选项联用。用树形格式来显示进程；如：ps -ef 等
- `-l`：显示长格式输出，包括进程的命令行。
- `u`：使用详细格式显示进程信息，包括进程的所有者、CPU 占用率（%）、内存占用率（%）等
- `a`：显示终端上的所有进程，包括其他用户的进程
- `x`：显示没有控制终端的进程，即后台运行的进程
- `-o`：自定义输出格式，可以指定要显示的列
- `-r`：按 CPU 使用率排序，显示 CPU 使用率最高的进程
- `-N`: 反选，显示不符合指定条件的进程

### 2. 使用方法实例

#### 显示所有进程的详细信息（包括后台运行的进程）

```bash
# a 参数用于显示所有用户的进程，u 参数用于使用详细格式显示进程信息，x 参数用于显示后台运行的进程
ps aux
```

- USER：表示哪个用户启动了这个进程
- PID ：进程 ID
- %CPU：进程 CPU 的占用率
- %MEM：进程物理内存的占用率
- VSZ ：进程占用的虚拟内存量 (Kbytes)
- RSS ：进程当前实际上占用了多少内存
- TTY ：进程是在哪个终端机上面运作，若与终端机无关，则显示 ?，另外， tty1-tty6 是本机上面的登入者程序，若为 pts/0 等等的，则表示为由网络连接进主机的程序。
- STAT：该程序目前的状态，主要的状态有
  - R ：运行；该程序目前正在运作，或者是可被运作
  - D：不可中断：一般是 IO 进程
  - S ：中断；该程序目前正在睡眠当中 (可说是 idle 状态)，但可被某些讯号 (signal) 唤醒。
  - T ：停止：该程序目前正在侦测或者是停止了
  - Z ：僵尸：该程序应该已经终止，但是其父程序却无法正常的终止他，造成 zombie (僵尸) 程序的状态
- START：该进程启动的时间点
- TIME ：进程从启动后到现在，实际占用 CPU 的总时间
- COMMAND：启动该进程的命令

#### 显示当前所有进程详细信息

```bash
ps -ef
```

- UID：表示用户 ID
- PID：表示进程 ID
- PPID：表示父进程号
- C：表示 CPU 的占用率
- STIME：进程的启动时间
- TTY：登入者的终端机位置
- IME：表示进程执行起到现在总的 CPU 占用时间
- CMD：表示启动这个进程的命令

#### 显示指定用户的进程信息

```bash
ps -u username
```

#### 显示指定进程的信息

```bash
ps -p PID
```

### 常用实际应用案例

- **查看系统负载情况**：通过 `ps aux` 命令查看当前系统所有进程的 CPU 和内存占用情况，帮助排查系统负载高的原因。
- **查找特定进程**：通过 `ps -ef | grep process_name` 查找特定进程的信息，用于监控和管理。
- **定时监控进程**：结合 `watch` 命令，定时执行 `ps` 命令，实时监控系统中的进程运行情况。

## sort

sort 的工作原理是将文件的每一行作为一个单位，相互比较，比较原则是从收字符向后，依次按照 ASCII 码值进行比较，最后将它们**按升序输出**。

### 选项

`-u` 去除重复行

`-r` 指定排序方式为降序（从大到小），sort 默认的排序方式是升序

`-o` 将排序结果写入文件（包括原文件），sort 默认是吧结果输出到标准输出，所以需要用重定向才能将结果写入文件，例如 `sort filename > newfile`，但是，重定向不能把排序结果输出到原文件（重定向到原文件会清空原文件）

`-n` 以数值来排序，默认的 ASCII 码值会出现 10 比 2 小的情况

`-t` 设置间隔符，指定间隔符后就可以用 `-k` 来指定列数了

`-k` 指定排序的列数

`-f` 忽略大小写，会将小写字母都转换为大写字母来进行比较

`-b` 忽略每行前面的所有空白部分，从第一个可见字符开始比较

`-c` 检查文件是否已经排好序，如果乱序则输出第一个乱序的行

`-M` 按月份排序

`-V` 按版本号排序

#### `-k` 详解

详细的语法格式：

`[ FStart [ .CStart ] ] [ Modifier ] [ , [ FEnd [ .CEnd ] ][ Modifier ] ]`

这个语法格式可以被其中的逗号（“，”）分为两大部分，Start 部分和 End 部分。

“如果不设定 End 部分，那么就认为 End 被设定为行尾”。这个概念很重要的。

Start 部分也由三部分组成，其中的 Modifier 部分就是我们之前说过的类似 n 和 r 的选项部分。我们重点说说 Start 部分的 FStart 和 C.Start。

C.Start 也是可以省略的，省略的话就表示从本域的开头部分开始。之前例子中的-k 2 和-k 3 就是省略了 C.Start 的例子喽。

FStart.CStart，其中 FStart 就是表示使用的域，而 CStart 则表示在 FStart 域中从第几个字符开始算“排序首字符”。

同理，在 End 部分中，你可以设定 FEnd.CEnd，如果你省略.CEnd，则表示结尾到“域尾”，即本域的最后一个字符。或者，如果你将 CEnd 设定为 0(零)，也是表示结尾到“域尾”

```bash
# -t 使用空格拆分列，-k 按照第三列降序排序（r），如果第三列相同，则按照第二列升序排序
sort -t ' ' -k 3r -k2 test.txt

# -t 使用空格拆分列，按照第二列的第二个字符到第三列的第一个字符排序
sort -t ' ' -n -k 2.2,3.1 test.txt
```

## more

功能类似 cat ，cat 命令是将整个文件的内容从上到下显示在屏幕上。 more 命令会一页一页的显示，方便使用者逐页阅读

### 每次显示 5 行

```bash
more -5 test.txt
```

### 从第 5 行开始显示

```bash
more +5 test.txt
```

### 每次翻页时，先清空屏幕内容

```bash
more -5 -p test.txt
```

### 若遇到连续两行以上的空白行，合并为一行空白行

```bash
more -s test.txt
```

### 执行 more 命令后，常用的操作

#### 向下滚动一屏

```
z
空格键
ctrl+f
```

#### 向上滚动一屏

```
b
ctrl+b
```

#### 输出文件名和当前行的行号

```bash
:f
```

### 进入 vim 编辑器

```bash
v
```

### 退出 more 模式

```bash
q
```

## less

less 命令也是对文件或其它输出进行分页显示的工具，应该说是 linux 正统查看文件内容的工具，功能极其强大

### 查看文件

```bash
less test.txt
```

### ps 查看进程并通过 less 分页显示

```bash
ps -ef | less
```

### 显示当前行数的百分比

```bash
less -m test.txt
```

### 显示当前行数/总行数和百分比

```bash
less -M test.txt
```

### 显示连续空行为一行

```bash
less -s test.txt
```

### 进入 less 模式之后的操作

g：移动到第一行

G：移动到最后一行

u：向前移动半屏

d：向后移动半屏

f：向后移动指定行数或一屏

b：向前移动指定行数或一屏

j：向下移动一行

k：向上移动一行

q：结束 less 模式

## head

## tail

```

```
