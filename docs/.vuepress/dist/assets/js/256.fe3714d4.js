(window.webpackJsonp=window.webpackJsonp||[]).push([[256],{723:function(s,a,e){"use strict";e.r(a);var t=e(25),r=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"ssh-免密登录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ssh-免密登录"}},[s._v("#")]),s._v(" SSH 免密登录")]),s._v(" "),a("p",[s._v("要配置 macOS 从 SSH 免密登录 CentOS 服务器，你需要在 macOS 上生成 SSH 密钥对，并将公钥上传到 CentOS 服务器。这样设置后，用户就不需要每次连接时输入密码。下面是具体步骤：")]),s._v(" "),a("h3",{attrs:{id:"步骤-1-在-macos-上生成-ssh-密钥对"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#步骤-1-在-macos-上生成-ssh-密钥对"}},[s._v("#")]),s._v(" 步骤 1: 在 macOS 上生成 SSH 密钥对")]),s._v(" "),a("ol",[a("li",[s._v("打开 macOS 上的终端。")]),s._v(" "),a("li",[s._v("输入以下命令生成 SSH 密钥对："),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("ssh-keygen "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" rsa "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-b")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("\n")])])])]),s._v(" "),a("li",[s._v("按照提示操作，可以为密钥设置密码（可选），并确认保存路径（默认是 "),a("code",[s._v("~/.ssh/id_rsa")]),s._v("）。")]),s._v(" "),a("li",[s._v("生成的密钥对包括私钥文件 "),a("code",[s._v("id_rsa")]),s._v(" 和公钥文件 "),a("code",[s._v("id_rsa.pub")]),s._v("。")])]),s._v(" "),a("h4",{attrs:{id:"ssh-keygen-基本选项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ssh-keygen-基本选项"}},[s._v("#")]),s._v(" ssh-keygen 基本选项")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("-t type")]),s._v("\n指定生成密钥的类型。常见的类型有 "),a("code",[s._v("rsa")]),s._v(", "),a("code",[s._v("dsa")]),s._v(", "),a("code",[s._v("ecdsa")]),s._v(", "),a("code",[s._v("ed25519")]),s._v(" 等。例如："),a("code",[s._v("ssh-keygen -t rsa")]),s._v("。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("-b bits")]),s._v("\n指定密钥的长度。对于 RSA 密钥，推荐的最小长度是 2048 位，通常使用 4096 位以增强安全性。例如："),a("code",[s._v("ssh-keygen -t rsa -b 4096")]),s._v("。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("-C comment")]),s._v("\n为密钥对添加一个注释，通常用于标识密钥的用途或持有者的信息。例如："),a("code",[s._v('ssh-keygen -t rsa -C "your_email@example.com"')]),s._v("。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("-f filename")]),s._v("\n指定生成密钥存储的文件名。如果不使用这个选项，默认会存储在 "),a("code",[s._v("~/.ssh/id_rsa")]),s._v("（私钥）和 "),a("code",[s._v("~/.ssh/id_rsa.pub")]),s._v("（公钥）。")])])]),s._v(" "),a("h4",{attrs:{id:"高级选项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#高级选项"}},[s._v("#")]),s._v(" 高级选项")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("-N passphrase")]),s._v("\n为生成的密钥设置一个短语密码。如果设置了密码，每次使用密钥时都需要输入此密码。例如："),a("code",[s._v('ssh-keygen -t rsa -N "your_password"')]),s._v("。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("-e")]),s._v("\n用于读取一个私钥或公钥文件，然后将其输出为指定的格式。常用于将 SSH 密钥转换为其他格式。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("-p")]),s._v("\n用于修改密钥文件的密码。这个选项不会改变密钥本身，只改变保护密钥的密码。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("-q")]),s._v("\n安静模式，不输出任何信息。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("-m format")]),s._v("\n指定密钥导出格式，用于密钥的导出或转换。支持的格式包括 "),a("code",[s._v("PEM")]),s._v("（默认的 RSA 和 DSA）、"),a("code",[s._v("PKCS8")]),s._v("（推荐的私钥存储格式）等。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("-o")]),s._v("\n保存私钥时使用新的（更安全的）格式。这是 OpenSSH 7.8 及以上版本的默认行为。")])])]),s._v(" "),a("h4",{attrs:{id:"示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[s._v("#")]),s._v(" 示例")]),s._v(" "),a("p",[s._v("生成一个类型为 RSA，长度为 4096 位的密钥，带有邮箱地址作为注释：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("ssh-keygen "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" rsa "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-b")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-C")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"your_email@example.com"')]),s._v("\n")])])]),a("p",[s._v("修改现有密钥的密码：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("ssh-keygen "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" ~/.ssh/id_rsa\n")])])]),a("p",[s._v("转换密钥格式为 PKCS8：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("ssh-keygen "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" PKCS8 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" keyfile\n")])])]),a("p",[s._v("s")]),s._v(" "),a("h3",{attrs:{id:"步骤-2-将-ssh-公钥上传到-centos-服务器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#步骤-2-将-ssh-公钥上传到-centos-服务器"}},[s._v("#")]),s._v(" 步骤 2: 将 SSH 公钥上传到 CentOS 服务器")]),s._v(" "),a("ol",[a("li",[s._v("使用 "),a("code",[s._v("ssh-copy-id")]),s._v(" 命令将你的公钥添加到 CentOS 服务器的 "),a("code",[s._v("~/.ssh/authorized_keys")]),s._v(" 文件中。假设你的 CentOS 服务器用户为 "),a("code",[s._v("abc")]),s._v("，服务器 IP 为 "),a("code",[s._v("server_ip")]),s._v("，则命令为："),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("ssh-copy-id "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" ~/.ssh/id_rsa.pub abc@server_ip\n")])])])]),s._v(" "),a("li",[s._v("如果没有 "),a("code",[s._v("ssh-copy-id")]),s._v(" 可用，你可以手动上传公钥：\n"),a("ul",[a("li",[s._v("首先，在 macOS 终端查看并复制公钥内容："),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" ~/.ssh/id_rsa.pub\n")])])])]),s._v(" "),a("li",[s._v("然后，登录到 CentOS 服务器："),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" abc@server_ip\n")])])])]),s._v(" "),a("li",[s._v("创建 "),a("code",[s._v(".ssh")]),s._v(" 目录并修改权限（如果尚未创建）："),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" ~/.ssh\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("700")]),s._v(" ~/.ssh\n")])])])]),s._v(" "),a("li",[s._v("添加公钥到 "),a("code",[s._v("authorized_keys")]),s._v(" 文件并设置正确的权限："),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"粘贴你的公钥内容"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" ~/.ssh/authorized_keys\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("600")]),s._v(" ~/.ssh/authorized_keys\n")])])])]),s._v(" "),a("li",[s._v("退出 SSH："),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n")])])])])])])]),s._v(" "),a("h3",{attrs:{id:"步骤-3-从-macos-使用-ssh-免密登录-centos-服务器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#步骤-3-从-macos-使用-ssh-免密登录-centos-服务器"}},[s._v("#")]),s._v(" 步骤 3: 从 macOS 使用 SSH 免密登录 CentOS 服务器")]),s._v(" "),a("ul",[a("li",[s._v("完成上述步骤后，尝试从你的 macOS 终端通过 SSH 连接到 CentOS 服务器，应该不再需要密码："),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" abc@server_ip\n")])])])])]),s._v(" "),a("h3",{attrs:{id:"注意事项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#注意事项"}},[s._v("#")]),s._v(" 注意事项")]),s._v(" "),a("ul",[a("li",[s._v("确保 CentOS 服务器的 SSH 配置（位于 "),a("code",[s._v("/etc/ssh/sshd_config")]),s._v("）允许公钥认证：\n"),a("ul",[a("li",[a("code",[s._v("PubkeyAuthentication yes")])]),s._v(" "),a("li",[s._v("如果更改了配置文件，需要重启 SSH 服务："),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl restart sshd\n")])])])])])]),s._v(" "),a("li",[s._v("保护好你的私钥文件，不要泄露给其他人。")])]),s._v(" "),a("h4",{attrs:{id:"建议"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#建议"}},[s._v("#")]),s._v(" 建议：")]),s._v(" "),a("p",[a("code",[s._v("/etc/ssh/sshd_config")]),s._v(" 修改：")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("PermitRootLogin no\nPasswordAuthentication yes\n")])])]),a("p",[s._v("PermitRootLogin 应该设置为 no（出于安全考虑，不建议允许 root 用户通过 SSH 登录）。\nPasswordAuthentication 可以设置为 yes，如果你希望通过密码进行认证。")])])}),[],!1,null,null,null);a.default=r.exports}}]);