(window.webpackJsonp=window.webpackJsonp||[]).push([[249],{717:function(a,s,t){"use strict";t.r(s);var e=t(25),r=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"服务器磁盘清理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#服务器磁盘清理"}},[a._v("#")]),a._v(" 服务器磁盘清理")]),a._v(" "),s("p",[a._v("当服务器磁盘满了时，需要有条不紊地排查并清理不必要的文件和数据。以下是逐步的排查和清理步骤以及每一步的具体指令：")]),a._v(" "),s("h3",{attrs:{id:"_1-检查磁盘使用情况"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-检查磁盘使用情况"}},[a._v("#")]),a._v(" 1. 检查磁盘使用情况")]),a._v(" "),s("p",[a._v("首先，检查哪些目录和文件占用了大量空间。")]),a._v(" "),s("h4",{attrs:{id:"检查磁盘使用情况"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#检查磁盘使用情况"}},[a._v("#")]),a._v(" 检查磁盘使用情况")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("df")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-h")]),a._v("\n")])])]),s("p",[a._v("这个命令会显示所有文件系统的使用情况。")]),a._v(" "),s("h4",{attrs:{id:"查找占用空间最大的目录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查找占用空间最大的目录"}},[a._v("#")]),a._v(" 查找占用空间最大的目录")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("du")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-h")]),a._v(" --max-depth"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" / "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sort")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-h")]),a._v("\n")])])]),s("p",[a._v("从根目录开始，查找哪个一级目录占用最多空间。可以逐层深入，例如：")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("du")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-h")]),a._v(" --max-depth"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" /var "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sort")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-h")]),a._v("\n")])])]),s("h3",{attrs:{id:"_2-清理日志文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-清理日志文件"}},[a._v("#")]),a._v(" 2. 清理日志文件")]),a._v(" "),s("p",[a._v("日志文件可能会占用大量空间，特别是在 "),s("code",[a._v("/var/log")]),a._v(" 目录下。")]),a._v(" "),s("h4",{attrs:{id:"查看日志目录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查看日志目录"}},[a._v("#")]),a._v(" 查看日志目录")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /var/log\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ls")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-lh")]),a._v("\n")])])]),s("h4",{attrs:{id:"清理日志文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#清理日志文件"}},[a._v("#")]),a._v(" 清理日志文件")]),a._v(" "),s("p",[a._v("清空大日志文件而不删除文件：")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" large_log_file.log\n")])])]),s("p",[a._v("或者删除旧的日志文件：")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" old_log_file.log\n")])])]),s("h3",{attrs:{id:"_3-清理缓存"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-清理缓存"}},[a._v("#")]),a._v(" 3. 清理缓存")]),a._v(" "),s("h4",{attrs:{id:"清理-apt-缓存-适用于-debian-ubuntu"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#清理-apt-缓存-适用于-debian-ubuntu"}},[a._v("#")]),a._v(" 清理 APT 缓存（适用于 Debian/Ubuntu）")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt-get")]),a._v(" clean\n")])])]),s("h4",{attrs:{id:"清理-yum-缓存-适用于-centos-rhel"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#清理-yum-缓存-适用于-centos-rhel"}},[a._v("#")]),a._v(" 清理 Yum 缓存（适用于 CentOS/RHEL）")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" yum clean all\n")])])]),s("h3",{attrs:{id:"_4-删除无用的文件和目录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-删除无用的文件和目录"}},[a._v("#")]),a._v(" 4. 删除无用的文件和目录")]),a._v(" "),s("h4",{attrs:{id:"查找和删除大文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查找和删除大文件"}},[a._v("#")]),a._v(" 查找和删除大文件")]),a._v(" "),s("p",[a._v("查找大于 100MB 的文件：")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("find")]),a._v(" / "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-type")]),a._v(" f "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-size")]),a._v(" +100M\n")])])]),s("p",[a._v("根据需要删除无用的大文件：")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" /path/to/large/file\n")])])]),s("h3",{attrs:{id:"_5-清理-docker-占用的空间"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-清理-docker-占用的空间"}},[a._v("#")]),a._v(" 5. 清理 Docker 占用的空间")]),a._v(" "),s("h4",{attrs:{id:"删除停止的容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#删除停止的容器"}},[a._v("#")]),a._v(" 删除停止的容器")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" container prune\n")])])]),s("h4",{attrs:{id:"删除无用的镜像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#删除无用的镜像"}},[a._v("#")]),a._v(" 删除无用的镜像")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" image prune "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v("\n")])])]),s("h4",{attrs:{id:"删除无用的数据卷"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#删除无用的数据卷"}},[a._v("#")]),a._v(" 删除无用的数据卷")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" volume prune\n")])])]),s("h4",{attrs:{id:"删除无用的网络"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#删除无用的网络"}},[a._v("#")]),a._v(" 删除无用的网络")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" network prune\n")])])]),s("h4",{attrs:{id:"删除所有未使用的-docker-资源"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#删除所有未使用的-docker-资源"}},[a._v("#")]),a._v(" 删除所有未使用的 Docker 资源")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" system prune "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v("\n")])])]),s("h3",{attrs:{id:"_6-清理临时文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-清理临时文件"}},[a._v("#")]),a._v(" 6. 清理临时文件")]),a._v(" "),s("h4",{attrs:{id:"清理系统临时文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#清理系统临时文件"}},[a._v("#")]),a._v(" 清理系统临时文件")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rf")]),a._v(" /tmp/*\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rf")]),a._v(" /var/tmp/*\n")])])]),s("h3",{attrs:{id:"_7-检查和清理用户目录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-检查和清理用户目录"}},[a._v("#")]),a._v(" 7. 检查和清理用户目录")]),a._v(" "),s("p",[a._v("用户目录下也可能有大量无用文件，如下载的安装包、临时文件等。")]),a._v(" "),s("h4",{attrs:{id:"查找并删除大文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查找并删除大文件"}},[a._v("#")]),a._v(" 查找并删除大文件")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("find")]),a._v(" /home "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-type")]),a._v(" f "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-size")]),a._v(" +100M\n")])])]),s("p",[a._v("根据需要删除无用的大文件：")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" /home/user/large_file\n")])])]),s("h3",{attrs:{id:"_8-卸载不再需要的软件包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-卸载不再需要的软件包"}},[a._v("#")]),a._v(" 8. 卸载不再需要的软件包")]),a._v(" "),s("p",[a._v("卸载不再需要的软件包可以释放一些空间。")]),a._v(" "),s("h4",{attrs:{id:"列出已安装的软件包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#列出已安装的软件包"}},[a._v("#")]),a._v(" 列出已安装的软件包")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("dpkg-query "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-l")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("less")]),a._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 适用于 Debian/Ubuntu")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("rpm")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-qa")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("less")]),a._v("        "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 适用于 CentOS/RHEL")]),a._v("\n")])])]),s("h4",{attrs:{id:"卸载软件包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#卸载软件包"}},[a._v("#")]),a._v(" 卸载软件包")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt-get")]),a._v(" remove package_name  "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 适用于 Debian/Ubuntu")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" yum remove package_name      "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 适用于 CentOS/RHEL")]),a._v("\n")])])]),s("h3",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[a._v("#")]),a._v(" 总结")]),a._v(" "),s("p",[a._v("通过以上步骤，可以有效地排查并清理服务器上不必要的数据和文件，释放磁盘空间。每一步操作前请确认文件和数据是否不再需要，以避免误删除重要内容。")])])}),[],!1,null,null,null);s.default=r.exports}}]);